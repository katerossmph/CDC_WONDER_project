---
title: "Trends in Chronic Disease Mortality in Massachusetts from 2021 to 2023"
author: "Kate Ross"
date: "2025-11-14"
output: 
  html_document:
    toc: true
#    toc_depth: 2
    theme: cerulean
---

```{r setup, include=FALSE}
# Load required packages
library(tidyverse)
library(readxl)
library(here)
library(scales)

# Set default chunk options
knitr::opts_chunk$set(
  echo = TRUE,          # Show code
  warning = FALSE,      # Hide warnings
  message = FALSE       # Hide messages
)

# Source project functions

# Load processed data
clean_data <- read_csv(here("data/processed/clean_data.csv"))
mort_selected <- read_csv(here("data/processed/mort_selected.csv"))
```

## Project Overview

This project analyzes trends in mortality from major chronic diseases (heart disease, diabetes, and stroke) in Massachusetts from 2021 to 2023. Analyses explore patterns by year, sex, age, group, and county, highlighting disparities and trends in deaths.

### Data

The cleaned mortality dataset was prepared from CDC WONDER data. key variables include:

-   `cause_category` (Heart Disease, Diabetes, Stroke)

-   `year` (2021 - 2023)

-   `sex` (Male/Female)

-   `age_group`

-   `county`

-   `deaths` (Number of deaths)

## Exploratory Analyses

### Overall Deaths by Cause

``` {r Total Deaths by Cause Category, echo = TRUE, message = FALSE, warning = FALSE}

overall_by_cause <- clean_data %>%
  filter(cause_category %in% c("Heart Disease", "Diabetes", "Stroke")) %>%
  group_by(cause_category) %>%
  summarise(total_deaths = sum(deaths, na.rm = TRUE)) %>%
  arrange(desc(total_deaths))

overall_by_cause

```

**Interpretation:** Heart disease accounts for the majority of deaths, followed by stroke and diabetes.

### Trends in Deaths Over Years
``` {r Trend in Deaths Over Years, echo = TRUE, message = FALSE, warning = FALSE}

ggplot(clean_data, aes(x = year, y = deaths, color = cause_category)) +
  geom_line(stat = "summary", fun = sum) +
  scale_x_continuous(breaks = c(2021, 2022, 2023)) +
  scale_y_continuous(labels = comma) +
  labs(title = "Total Deaths by Cause Over Years",
       x = "Year", y = "Total Deaths") +
  theme_minimal()

```
**Interpretation:** The trend in deaths from 2021 - 2023 shows that the rates of mortality due to heart disease were consistently higher than that of diabetes and stroke deaths. However the other mortality causes were greater than that of Heart Disease co-morbidities 

### Deaths by Sex
``` {r Deaths by Sex, echo = TRUE, message = FALSE, warning = FALSE}

overall_by_sex <- clean_data %>%
group_by(sex) %>%
summarise(total_deaths = sum(deaths, na.rm = TRUE))

overall_by_sex

sex_by_cause <- clean_data %>%
filter(cause_category %in% c("Heart Disease", "Diabetes", "Stroke")) %>%
group_by(sex, cause_category) %>%
summarise(total_deaths = sum(deaths, na.rm = TRUE))

sex_by_cause

```
**Interpretation:** Females had higher total deaths overall. Heart Disease remained the leading cause in both sexes. Females had a higher leading cause of stroke relative to men. 


### Deaths by Sex, Cause, and Year

```{r deaths-sex-cause-year, echo=TRUE, message=FALSE, warning=FALSE}
library(dplyr)
library(ggplot2)
library(scales)

# Summarize deaths by year, sex, and cause
deaths_by_sex <- clean_data %>%
  filter(cause_category %in% c("Heart Disease", "Diabetes", "Stroke")) %>%
  group_by(year, sex, cause_category) %>%
  summarise(total_deaths = sum(deaths, na.rm = TRUE), .groups = "drop")

# Plot deaths by sex, cause, and year
ggplot(deaths_by_sex, aes(x = sex, y = total_deaths, fill = cause_category)) +
  geom_col(position = "dodge") +
  facet_wrap(~year) +
  scale_y_continuous(labels = comma) +
  labs( #title = "Deaths by Sex, Cause, and Year",
       x = "Sex", y = "Total Deaths") +
  theme_minimal()
```
**Interpretation:** The faceted plot demonstrates how deaths for each cause differ between men and women across years. 

### Deaths by Age Group

```{r deaths-by-age-group, echo=TRUE, message=FALSE, warning=FALSE}

overall_by_age <- clean_data %>%
group_by(age_group) %>%
summarise(total_deaths = sum(deaths, na.rm = TRUE))

overall_by_age

```
**Interpretation:** [Add interpretation on which age groups have the highest mortality for each cause.]

### Deaths by County

```{r deaths-by-county, echo=TRUE, message=FALSE, warning=FALSE}

deaths_by_county <- clean_data %>%
filter(cause_category %in% c("Heart Disease", "Diabetes", "Stroke")) %>%
group_by(county, cause_category) %>%
summarise(total_deaths = sum(deaths, na.rm = TRUE))

deaths_by_county

```
**Interpretation:** Counties such as Middlesex and Essex show the highest total deaths over the three years, particularly for heart disease. 

## 1. Load Data

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
